/**
 * 职教专用布局样式 - CSS Grid 实现
 * 
 * 包含:
 * - 6 种核心布局的 CSS Grid 定义
 * - 文本溢出熔断机制 (Overflow Breaker)
 * - 导出友好约束 (Export-Friendly)
 * - 响应式样式注入 (StyleConfig Integration)
 */

/* ============================================================================
   全局设置
   ============================================================================ */

/* ============================================================================
   全局设置 & 布局基础
   ============================================================================ */

.reveal .slides section {
    text-align: left;
    padding: 3rem;
    box-sizing: border-box;
    font-family: var(--font-body, "Microsoft YaHei", sans-serif);
    color: var(--color-text, #2c3e50);
    height: 100%;
    /* 确保内容垂直分布 */
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* 底部装饰条 - 增加页面丰富度 */
.reveal .slides section::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 8px;
    background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
    opacity: 0.8;
}

/* 通用标题样式 */
.slide-title {
    font-family: var(--font-title, "Microsoft YaHei", sans-serif);
    color: var(--color-primary, #2c3e50);
    line-height: 1.2;
    margin-bottom: 0.8em;
    /* 稍微增加间距 */
    position: relative;
    padding-bottom: 0.5rem;
}

/* 标题下划线装饰 (更精致) */
.slide-title::after {
    content: "";
    display: block;
    width: 60px;
    height: 4px;
    background: var(--color-accent, #3498db);
    margin-top: 10px;
    border-radius: 2px;
}

/* ============================================================================
   布局 1: title_only (高度居中，视觉聚焦)
   ============================================================================ */

.layout-title-only {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    background: var(--color-background-gradient, transparent);
}

.layout-title-only .slide-title {
    font-size: 5rem;
    /* 更大的标题 */
    font-weight: 800;
    text-align: center;
    color: var(--color-primary, #2c3e50);
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    margin-bottom: 0;
}

.layout-title-only .slide-title::after {
    display: none;
    /* 封面页不需要下划线 */
}

/* =========================================
   布局 2: title_bullets (悬浮居中流体布局)
   ========================================= */

.layout-title-bullets {
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* 垂直居中 */
    align-items: center;
    /* 水平居中 */
    height: 100%;
    width: 100%;

    /* ❌ 移除所有背景板样式 */
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0;
}

/* 标题样式：居中且与内容保持距离 */
.layout-title-bullets .slide-title {
    text-align: center;
    margin-bottom: 3rem;
    width: 80%;

    /* 增强文字投影，防止背景图干扰 */
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    border-bottom: none;
    /* 去掉分割线 */
}

/* 标题下划线居中 */
.layout-title-bullets .slide-title::after {
    margin: 15px auto 0;
}

/* 列表容器：限制宽度，完全透明 */
.layout-title-bullets .bullets-container {
    width: 70%;
    max-width: 900px;
    background: transparent !important;
    /* 关键：透明 */
    box-shadow: none !important;
    border: none !important;
    border-left: none !important;
    padding: 0 !important;
}

.layout-title-bullets .bullet-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    /* 增加间距，增加透气感 */
    max-height: none;
    /* 移除高度限制 */
}

/* 卡片项：极简毛玻璃悬浮条 */
.layout-title-bullets .bullet-item {
    /* 毛玻璃背景：既能透出背景，又能保证文字清晰 */
    background: rgba(255, 255, 255, 0.45);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);

    padding: 1.2rem 2rem;
    border-radius: 16px;
    /* 更大的圆角 */
    border: 1px solid rgba(255, 255, 255, 0.6);
    /* 亮色细边框 */

    font-size: 1.8rem;
    color: var(--color-text);
    text-align: left;

    /* 柔和的悬浮投影 */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);

    position: relative;
    padding-left: 3.8rem;
    /* ✅ 修改点 1：减小左侧内边距，适应更小的圆点 */
    margin: 0;
    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1),
        background 0.3s ease,
        box-shadow 0.3s ease;
}

/* 悬停效果：上浮 + 加亮 */
.layout-title-bullets .bullet-item:hover {
    transform: translateY(-5px) scale(1.01);
    background: rgba(255, 255, 255, 0.8);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    z-index: 10;
}

/* 序号优化：悬浮球风格 */
.layout-title-bullets .bullet-item::before {
    counter-increment: section;
    content: counter(section);
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);

    /* ✅ 修改点 2：缩小尺寸 */
    width: 2.2rem;
    height: 2.2rem;
    border-radius: 50%;

    background: var(--color-accent);
    /* 使用主题色 */
    color: white;

    text-align: center;
    /* ✅ 修改点 3：调整字体和行高以匹配新尺寸 */
    line-height: 2.2rem;
    font-size: 1.1rem;
    font-weight: 700;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    /* 投影也稍微收一点 */
    content: counter(section);
    /* 重置 content */
    /* 增加一圈白边，增加层次感 */
    z-index: 2;
}

/* ============================================================================
   布局 3: title_bullets_right_img (更好的利用垂直空间)
   ============================================================================ */

.layout-title-bullets-right-img {
    display: grid;
    grid-template-areas:
        "title title"
        "bullets image";
    grid-template-columns: 1.1fr 0.9fr;
    grid-template-rows: min-content 1fr;
    gap: 2rem;
    height: 90%;
    align-items: start;
    /* 顶部对齐,防止标题被挤压 */
}

.layout-title-bullets-right-img .content-bullets {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    /* 内容顶部对齐 */
    background: var(--color-surface, #f8f9fa);
    /* 使用 light surface 确保对比度 */
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    /* 轻微浮起 */
}

.layout-title-bullets-right-img .content-image {
    width: 100%;
    height: 100%;
    max-height: 70vh;
    /* 限制最大高度 */
    display: flex;
    justify-content: center;
    align-items: center;
    background: white;
    padding: 1rem;
    border-radius: var(--border-radius, 12px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    /* 图片更强的阴影 */
}

.layout-title-bullets-right-img .bullet-item {
    font-size: 2rem;
    line-height: 1.6;
    margin-bottom: 1.8rem;
}

/* ============================================================================
   布局 4: operation_steps (优化步骤球颜色)
   ============================================================================ */

.layout-operation-steps {
    display: grid;
    grid-template-areas:
        "title title"
        "image steps";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 90%;
    align-items: center;
}

.layout-operation-steps .content-steps {
    background: var(--color-surface, #f8f9fa);
    padding: 2.5rem;
    border-radius: var(--border-radius, 12px);
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.layout-operation-steps .step-item {
    font-size: 1.8rem;
    margin-bottom: 2rem;
}

.layout-operation-steps .step-item::before {
    /* 确保步骤球内文字是白色的 */
    color: white !important;
    background: var(--color-primary, #2c3e50);
    width: 2.5rem;
    height: 2.5rem;
    font-size: 1.4rem;
    line-height: 2.5rem;
    /* 垂直居中 */
    text-align: center;
}

/* ============================================================================
   布局 5: concept_comparison (增强对比卡片)
   ============================================================================ */

.layout-concept-comparison {
    display: grid;
    grid-template-areas:
        "title title"
        "left right";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 90%;
}

.layout-concept-comparison .slide-title {
    text-align: center;
    margin-bottom: 1rem;
}

.layout-concept-comparison .slide-title::after {
    margin: 10px auto 0;
    /* 居中下划线 */
}

.layout-concept-comparison .comparison-left,
.layout-concept-comparison .comparison-right {
    padding: 2rem;
    border-radius: 16px;
    background: white;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.06);
    border-top: 6px solid var(--color-muted);

    display: flex;
    flex-direction: column;
    align-items: center;
    /* 内容居中 */
}

.layout-concept-comparison .comparison-left {
    border-color: #27ae60;
    /* 绿色代表正确/左侧 */
}

.layout-concept-comparison .comparison-right {
    border-color: var(--color-warning, #c0392b);
    /* 红色代表错误/右侧 */
}

.layout-concept-comparison .comparison-label {
    width: 100%;
    padding: 1rem;
    font-size: 2rem;
    color: white;
    /* 确保文字白色 */
    background: var(--color-primary);
    text-align: center;
    border-radius: 8px;
    margin-top: auto;
    /* 推到底部 */
}

/* ============================================================================
   布局 6: grid_4 (图像卡片)
   ============================================================================ */

.layout-grid-4 {
    display: grid;
    grid-template-areas:
        "title title"
        "item1 item2"
        "item3 item4";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr 1fr;
    gap: 2rem;
    height: 90%;
}

.layout-grid-4 .grid-item {
    background: var(--color-surface, #f8f9fa);
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    padding: 1rem;
    display: flex;
    justify-content: center;
    align-items: center;

    /* 强制约束内容不溢出 */
    overflow: hidden;
    height: 100%;
    position: relative;
    max-height: 100%;
    /* 防止被子元素撑大 */
}

.layout-grid-4 .image-placeholder {
    /* 占满容器 */
    width: 100%;
    height: 100%;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
}

.layout-grid-4 img {
    /* 强制填满且裁剪 */
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    left: 0;
    top: 0;
}

.layout-grid-4 .grid-label {
    font-size: 1.8rem;
    margin-top: 1rem;
    color: var(--color-primary);
    font-weight: bold;
}

/* 全局图片优化 */
img {
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* ============================================================================
   布局 1: title_only - 封面/过渡页
   ============================================================================ */

.layout-title-only {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    /* 添加一点背景纹理或渐变支持 */
    background: var(--color-background-gradient, transparent);
    border-radius: var(--border-radius, 0px);
}

.layout-title-only .slide-title {
    font-size: 4.5rem;
    font-weight: 800;
    text-align: center;
    color: var(--color-primary, #2c3e50);
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    /* 微妙阴影 */

    /* 文本溢出熔断 */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* ============================================================================
   布局 2: title_bullets - 目录/总结页
   ============================================================================ */

.layout-title-bullets {
    display: grid;
    grid-template-areas:
        "title title"
        "bullets bullets";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 100%;
}

.layout-title-bullets .slide-title {
    grid-area: title;
    font-size: 3rem;
    font-weight: 700;
    margin: 0;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--color-muted, #ecf0f1);
    /* 标题分割线 */

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-title-bullets .bullets-container {
    grid-area: bullets;
    background: var(--color-surface, #f8f9fa);
    /* 强制使用亮色背景以确保文字可读性 */
    padding: 2.5rem;
    border-radius: var(--border-radius, 12px);
    box-shadow: var(--box-shadow, 0 4px 6px rgba(0, 0, 0, 0.05));
    /* 使用配置阴影 */
    border-left: 5px solid var(--color-primary);
    /* 增加视觉层次 */
}

.layout-title-bullets .bullet-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: calc(10 * 4rem);
    overflow: hidden;
}

.layout-title-bullets .bullet-item {
    font-size: 1.8rem;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    padding-left: 2rem;
    position: relative;
    color: var(--color-text, #2c3e50);

    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-title-bullets .bullet-item::before {
    content: "•";
    position: absolute;
    left: 0;
    color: var(--color-accent, #3498db);
    font-size: 2.5rem;
    line-height: 1.8rem;
}

/* ============================================================================
   布局 3: title_bullets_right_img - 左文右图 (最常用)
   ============================================================================ */

.layout-title-bullets-right-img {
    display: grid;
    grid-template-areas:
        "title title"
        "bullets image";
    grid-template-columns: 1.2fr 1fr;
    /* 调整比例，给文字更多空间 */
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 100%;
}

.layout-title-bullets-right-img .slide-title {
    grid-area: title;
    font-size: 3rem;
    font-weight: 700;
    margin: 0;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--color-muted, #e0e0e0);

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-title-bullets-right-img .content-bullets {
    grid-area: bullets;
    padding-top: 1rem;
}

.layout-title-bullets-right-img .content-image {
    grid-area: image;
    display: flex;
    justify-content: center;
    align-items: center;

    /* 图片容器样式 */
    background: var(--color-secondary, #f8f9fa);
    border-radius: var(--border-radius, 12px);
    overflow: hidden;
    box-shadow: var(--box-shadow, 0 4px 6px rgba(0, 0, 0, 0.1));
}

.layout-title-bullets-right-img .bullet-list {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: calc(8 * 3.5rem);
    overflow: hidden;
}

.layout-title-bullets-right-img .bullet-item {
    font-size: 1.7rem;
    line-height: 1.5;
    margin-bottom: 1.5rem;
    padding-left: 2rem;
    position: relative;

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-title-bullets-right-img .bullet-item::before {
    content: "•";
    position: absolute;
    left: 0;
    color: var(--color-accent, #3498db);
    font-weight: bold;
    font-size: 2rem;
}

/* ============================================================================
   布局 4: operation_steps - 左图右步骤 (实训核心)
   ============================================================================ */

.layout-operation-steps {
    display: grid;
    grid-template-areas:
        "title title"
        "image steps";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 100%;
}

.layout-operation-steps .slide-title {
    grid-area: title;
    font-size: 3rem;
    font-weight: 700;
    margin: 0;

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-operation-steps .content-image {
    grid-area: image;
    /* 图片容器更明显 */
    border: 2px solid var(--color-muted, #eee);
    border-radius: var(--border-radius, 8px);
    background: white;
    box-shadow: var(--box-shadow, 0 4px 12px rgba(0, 0, 0, 0.1));
    overflow: hidden;
}

.layout-operation-steps .content-steps {
    grid-area: steps;
    background: var(--color-surface, #f8f9fa);
    /* 使用 surface 色 */
    padding: 2rem;
    border-radius: var(--border-radius, 8px);
}

.layout-operation-steps .step-list {
    list-style: none;
    counter-reset: step-counter;
    padding: 0;
    margin: 0;
    max-height: calc(6 * 5rem);
    overflow: hidden;
}

.layout-operation-steps .step-item {
    font-size: 1.6rem;
    line-height: 1.4;
    margin-bottom: 2rem;
    padding-left: 3.5rem;
    position: relative;
    counter-increment: step-counter;

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-operation-steps .step-item::before {
    content: counter(step-counter);
    position: absolute;
    left: 0;
    top: -2px;
    width: 2.2rem;
    height: 2.2rem;
    background: var(--color-primary, #2c3e50);
    /* 步骤球使用主色 */
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.1rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* ============================================================================
   布局 5: concept_comparison - 左右对比
   ============================================================================ */

.layout-concept-comparison {
    display: grid;
    grid-template-areas:
        "title title"
        "left right";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
    gap: 3rem;
    height: 100%;
}

.layout-concept-comparison .slide-title {
    grid-area: title;
    font-size: 3rem;
    font-weight: 700;
    margin: 0;
    text-align: center;
    /* 对比页标题居中 */

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-concept-comparison .comparison-left,
.layout-concept-comparison .comparison-right {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    padding: 2rem;
    border-radius: var(--border-radius, 12px);
    background: var(--color-surface, rgba(255, 255, 255, 0.5));
    border: 1px solid var(--color-muted, #eee);
}

.layout-concept-comparison .comparison-left {
    grid-area: left;
    /* 可以在这里添加具体的左侧强调色，如 --color-success-bg */
}

.layout-concept-comparison .comparison-right {
    grid-area: right;
}

.layout-concept-comparison .comparison-label {
    font-size: 1.8rem;
    font-weight: 700;
    text-align: center;
    margin: 0;
    padding: 1rem;
    background: var(--color-primary, #2c3e50);
    color: white;
    border-radius: 6px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* ============================================================================
   布局 6: grid_4 - 四宫格
   ============================================================================ */

.layout-grid-4 {
    display: grid;
    grid-template-areas:
        "title title"
        "item1 item2"
        "item3 item4";
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr 1fr;
    gap: 2rem;
    height: 100%;
}

.layout-grid-4 .slide-title {
    grid-area: title;
    font-size: 3rem;
    font-weight: 700;
    margin: 0;

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.layout-grid-4 .grid-item {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    background: white;
    padding: 1rem;
    border-radius: var(--border-radius, 8px);
    box-shadow: var(--box-shadow, 0 1px 3px rgba(0, 0, 0, 0.1));
    border: 1px solid var(--color-muted, #eee);
    transition: transform 0.2s;
}

.layout-grid-4 .grid-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.layout-grid-4 .grid-label {
    font-size: 1.5rem;
    font-weight: 600;
    text-align: center;
    margin: 0;
    color: var(--color-primary);

    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* ============================================================================
   导出友好约束 & 工具类
   ============================================================================ */

.reveal .slides section {
    transform-style: flat;
}

img {
    max-width: 100%;
    max-height: 100%;
    border-radius: 4px;
    /* 图片默认圆角 */
}